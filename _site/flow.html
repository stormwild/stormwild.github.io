<!doctype html><html lang="en"><head><meta charset="UTF-8"><title>Flow - Stormwild (Alexander R. Torrijos)</title><meta name="description" content="Stormwild (Alexander R. Torrijos)"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="shortcut icon" href="/dist/img/favicon.ico" type="image/x-icon"><link rel="icon" href="/dist/img/favicon.ico" type="image/x-icon"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Stormwild (Alexander R. Torrijos)" /><script defer="defer" src="/dist/js/bundle-c6c8ed.js"></script><link href="/dist/css/styles-c6c8ed.css" rel="stylesheet"></head><body><header class="navbar navbar-expand-md navbar-dark bg-dark navbar-toggleable-sm"><a href="/" class="navbar-brand"><img src="/dist/img/stormwild-logo.svg" alt="" width="30" height="30" class="d-inline-block align-top"> Stormwild </a><button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#mainNav" aria-controls="mainNav" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="mainNav"><ul class="navbar-nav ml-auto"><li class="nav-item"><a href="/" class="nav-link">Home</a></li><li class="nav-item"><a href="/cv" class="nav-link">CV</a></li><li class="nav-item"><a href="/blog" class="nav-link">Blog</a></li><li class="nav-item dropdown"><a href="#" class="nav-link dropdown-toggle" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Articles</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownMenuLink">    <a class="dropdown-item" href="/binary">Binary</a>    <a class="dropdown-item" href="/dba">DBA</a>    <a class="dropdown-item" href="/docker-notes">Docker Notes</a>              <a class="dropdown-item" href="/list-of-jekyll-plugins-supported-on-github-pages">List of Jekyll Plugins Supported On Github Pages</a>    <a class="dropdown-item" href="/notes">Notes</a>    <a class="dropdown-item" href="/permutations">Permutations</a>    <a class="dropdown-item" href="/selection-sort">Selection Sort</a>    <a class="dropdown-item" href="/ssl-tls-certificates">SSL TLS Certificates</a>                                        </div></li></ul></div></header><main class="main" role="main"><header class="main-header"><div class="container"><h1 class="page-header">Flow</h1><p class="text-muted"><small>02 Sep 2017</small></p></div></header><div class="container"><div class="row"><div class="col-md-8"><article class="main-article"><h2 id="notes-on-flow">Notes on <a href="https://flow.org/en/">Flow</a></h2>

<p>A copy paste of selections from the documentation.</p>

<blockquote>
  <p>Flow is a static type checker for your JavaScript code.</p>
</blockquote>

<p>You can write type annotations on your code to allow Flow to check your code for errors.</p>

<p>For example:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// @flow</span>
<span class="kd">function</span> <span class="nx">square</span><span class="p">(</span><span class="nx">n</span><span class="p">:</span> <span class="nx">number</span><span class="p">):</span> <span class="nx">number</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">n</span> <span class="o">*</span> <span class="nx">n</span><span class="p">;</span>
    
<span class="p">}</span>

<span class="nx">square</span><span class="p">(</span><span class="dl">"</span><span class="s2">2</span><span class="dl">"</span><span class="p">);</span> <span class="c1">// Error!</span>
</code></pre></div></div>

<h2 id="setup">Setup</h2>

<p>To allow Flow to check this code for type errors, configure your project to use Flow:</p>

<ol>
  <li>
    <p>Install Flow and a compiler to strip away type annotations</p>

    <p>Babel or flow-remove-types can be installed to remove the type annotations from your code.</p>

    <p>When using babel, install <code class="language-plaintext highlighter-rouge">babel-cli</code> and <code class="language-plaintext highlighter-rouge">babel-preset-flow</code></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> npm install babel-cli babel-preset-flow
</code></pre></div>    </div>

    <p>Add flow to your babel presets array in <code class="language-plaintext highlighter-rouge">.babelrc</code></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> {
   "presets": ["flow"]
 }
</code></pre></div>    </div>
  </li>
  <li>
    <p>Add flow</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> npm install --save-dev flow-bin
</code></pre></div>    </div>

    <p>Add a flow script to your <code class="language-plaintext highlighter-rouge">package.json</code></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> {
   "name": "my-flow-project",
   "version": "1.0.0",
   "devDependencies": {
     "flow-bin": "^0.41.0"
   },
   "scripts": {
     "flow": "flow"
   }
 }
</code></pre></div>    </div>
  </li>
  <li>
    <p>Configure the project to use Flow</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> npm run flow init
</code></pre></div>    </div>

    <p>This creates a <a href="https://flow.org/en/docs/config/"><code class="language-plaintext highlighter-rouge">.flowconfig</code></a> file which allows you to configure and customize Flow such as the path to the code.</p>
  </li>
  <li>
    <p>Run flow to check for type errors</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> npm run flow
</code></pre></div>    </div>

    <p>This is equivalent to <code class="language-plaintext highlighter-rouge">flow status</code></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> npm run flow status
</code></pre></div>    </div>

    <p>Which runs flow as a background process.</p>

    <p>Only one instance of the background process regardless of how many times <code class="language-plaintext highlighter-rouge">flow status</code> is called</p>

    <p>To stop the background process</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> npm run flow stop
</code></pre></div>    </div>

    <p>Flow will check source code files for error if the file begins with flow flag:</p>

    <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1">// @flow</span>
 <span class="cm">/* @flow */</span>
</code></pre></div>    </div>

    <p>It will skip files without the flag unless <code class="language-plaintext highlighter-rouge">flow check --all</code> is called.</p>
  </li>
</ol>

<h2 id="writing-flow">Writing Flow</h2>

<p>You can now begin to write JavaScript code with type annotations.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// @flow</span>

<span class="kd">function</span> <span class="nx">foo</span><span class="p">(</span><span class="nx">x</span><span class="p">:</span> <span class="p">?</span><span class="nx">number</span><span class="p">):</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">x</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="dl">"</span><span class="s2">default string</span><span class="dl">"</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>For the code above running flow will yield the following:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>test.js:5
  5:     return x;
                ^ number. This type is incompatible with the expected return type of
  3: function foo(x: ?number): string {
                               ^^^^^^ string
</code></pre></div></div>

<h2 id="primitive-types">Primitive Types</h2>

<p>Primitive types can be literal values <code class="language-plaintext highlighter-rouge">true "hello" 3.14 null undefined</code> or constructed wrapper objects <code class="language-plaintext highlighter-rouge">new Boolean(false) new String("world")</code>.</p>

<p>Types for literal values are lowercase and wrapper objects are capitalized.</p>

<p>Boolean values need to be explicitly converted to boolean using <code class="language-plaintext highlighter-rouge">Boolean(x) or !!x</code>.</p>

<h2 id="maybe-types">Maybe Types</h2>

<p>Maybe types are for places where a value is optional and you can create them by adding a question mark in front of the type such as <code class="language-plaintext highlighter-rouge">?string</code> or <code class="language-plaintext highlighter-rouge">?number</code>.</p>

<h2 id="optional-object-properties">Optional Object Properties</h2>

<p>Object types can have optional properties where a question mark <code class="language-plaintext highlighter-rouge">?</code> comes after the property name.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span> <span class="nx">propertyName</span><span class="p">?:</span> <span class="nx">string</span> <span class="p">}</span>
</code></pre></div></div>

<p>In addition to their set value type, these optional properties can either be void or omitted altogether. However, they cannot be <code class="language-plaintext highlighter-rouge">null</code>.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// @flow</span>
<span class="kd">function</span> <span class="nx">acceptsObject</span><span class="p">(</span><span class="nx">value</span><span class="p">:</span> <span class="p">{</span> <span class="nx">foo</span><span class="p">?:</span> <span class="nx">string</span> <span class="p">})</span> <span class="p">{</span>
  <span class="c1">// ...</span>
<span class="p">}</span>

<span class="nx">acceptsObject</span><span class="p">({</span> <span class="na">foo</span><span class="p">:</span> <span class="dl">"</span><span class="s2">bar</span><span class="dl">"</span> <span class="p">});</span>     <span class="c1">// Works!</span>
<span class="nx">acceptsObject</span><span class="p">({</span> <span class="na">foo</span><span class="p">:</span> <span class="kc">undefined</span> <span class="p">});</span> <span class="c1">// Works!</span>
<span class="nx">acceptsObject</span><span class="p">({</span> <span class="na">foo</span><span class="p">:</span> <span class="kc">null</span> <span class="p">});</span>      <span class="c1">// Error!</span>
<span class="nx">acceptsObject</span><span class="p">({});</span>                 <span class="c1">// Works!</span>
</code></pre></div></div>

<h2 id="optional-function-parameters">Optional function parameters</h2>

<p>Functions can have optional parameters where a question mark <code class="language-plaintext highlighter-rouge">?</code> comes after the parameter name.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">method</span><span class="p">(</span><span class="nx">param</span><span class="p">?:</span> <span class="nx">string</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">}</span>
</code></pre></div></div>

<p>In addition to their set type, these optional parameters can either be void or omitted altogether. However, they cannot be <code class="language-plaintext highlighter-rouge">null</code>.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// @flow</span>
<span class="kd">function</span> <span class="nx">acceptsOptionalString</span><span class="p">(</span><span class="nx">value</span><span class="p">?:</span> <span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...</span>
<span class="p">}</span>

<span class="nx">acceptsOptionalString</span><span class="p">(</span><span class="dl">"</span><span class="s2">bar</span><span class="dl">"</span><span class="p">);</span>     <span class="c1">// Works!</span>
<span class="nx">acceptsOptionalString</span><span class="p">(</span><span class="kc">undefined</span><span class="p">);</span> <span class="c1">// Works!</span>
<span class="nx">acceptsOptionalString</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>      <span class="c1">// Error!</span>
<span class="nx">acceptsOptionalString</span><span class="p">();</span>          <span class="c1">// Works!</span>
</code></pre></div></div>

<h2 id="function-parameters-with-defaults">Function parameters with defaults</h2>

<p>Function parameters can also have defaults. This is a feature of ECMAScript 2015.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">method</span><span class="p">(</span><span class="nx">value</span><span class="p">:</span> <span class="nx">string</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">default</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">}</span>
</code></pre></div></div>

<p>In addition to their set type, default parameters can also be void or omitted altogether. However, they cannot be <code class="language-plaintext highlighter-rouge">null</code>.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// @flow</span>
<span class="kd">function</span> <span class="nx">acceptsOptionalString</span><span class="p">(</span><span class="nx">value</span><span class="p">:</span> <span class="nx">string</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">foo</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...</span>
<span class="p">}</span>

<span class="nx">acceptsOptionalString</span><span class="p">(</span><span class="dl">"</span><span class="s2">bar</span><span class="dl">"</span><span class="p">);</span>     <span class="c1">// Works!</span>
<span class="nx">acceptsOptionalString</span><span class="p">(</span><span class="kc">undefined</span><span class="p">);</span> <span class="c1">// Works!</span>
<span class="nx">acceptsOptionalString</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>      <span class="c1">// Error!</span>
<span class="nx">acceptsOptionalString</span><span class="p">();</span>          <span class="c1">// Works!</span>
</code></pre></div></div>

<h2 id="symbols">Symbols</h2>

<p>Symbols are not currently supported by Flow. You can see these two issues for more information:</p>

<ul>
  <li><a href="https://github.com/facebook/flow/issues/810">facebook/flow#810</a></li>
  <li><a href="https://github.com/facebook/flow/issues/1015">facebook/flow#1015</a></li>
</ul>

<h2 id="literal-types">Literal Types</h2>

<p>Using literal values as types</p>

<blockquote>
  <p>Flow has primitive types for literal values, but can also use literal values as types.</p>
</blockquote>

<blockquote>
  <p>For example, instead of accepting number type, we could accept only the literal value 2.</p>
</blockquote>

<blockquote>
  <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// @flow</span>
<span class="kd">function</span> <span class="nx">acceptsTwo</span><span class="p">(</span><span class="nx">value</span><span class="p">:</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...</span>
<span class="p">}</span>

<span class="nx">acceptsTwo</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>   <span class="c1">// Works!</span>
<span class="c1">// $ExpectError</span>
<span class="nx">acceptsTwo</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>   <span class="c1">// Error!</span>
<span class="c1">// $ExpectError</span>
<span class="nx">acceptsTwo</span><span class="p">(</span><span class="dl">"</span><span class="s2">2</span><span class="dl">"</span><span class="p">);</span> <span class="c1">// Error!</span>
</code></pre></div>  </div>
</blockquote>

<blockquote>
  <p>Using these with union types is powerful:</p>
</blockquote>

<blockquote>
  <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// @flow</span>
<span class="kd">function</span> <span class="nx">getColor</span><span class="p">(</span><span class="nx">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">success</span><span class="dl">"</span> <span class="o">|</span> <span class="dl">"</span><span class="s2">warning</span><span class="dl">"</span> <span class="o">|</span> <span class="dl">"</span><span class="s2">danger</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">switch</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="dl">"</span><span class="s2">success</span><span class="dl">"</span> <span class="p">:</span> <span class="k">return</span> <span class="dl">"</span><span class="s2">green</span><span class="dl">"</span><span class="p">;</span>
    <span class="k">case</span> <span class="dl">"</span><span class="s2">warning</span><span class="dl">"</span> <span class="p">:</span> <span class="k">return</span> <span class="dl">"</span><span class="s2">yellow</span><span class="dl">"</span><span class="p">;</span>
    <span class="k">case</span> <span class="dl">"</span><span class="s2">danger</span><span class="dl">"</span>  <span class="p">:</span> <span class="k">return</span> <span class="dl">"</span><span class="s2">red</span><span class="dl">"</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">getColor</span><span class="p">(</span><span class="dl">"</span><span class="s2">success</span><span class="dl">"</span><span class="p">);</span> <span class="c1">// Works!</span>
<span class="nx">getColor</span><span class="p">(</span><span class="dl">"</span><span class="s2">danger</span><span class="dl">"</span><span class="p">);</span>  <span class="c1">// Works!</span>
<span class="c1">// $ExpectError</span>
<span class="nx">getColor</span><span class="p">(</span><span class="dl">"</span><span class="s2">error</span><span class="dl">"</span><span class="p">);</span>   <span class="c1">// Error!</span>
</code></pre></div>  </div>
</blockquote>

<h2 id="mixed-types">Mixed Types</h2>

<p>A single type:</p>

<p>Here the input value can only be a number.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">square</span><span class="p">(</span><span class="nx">n</span><span class="p">:</span> <span class="nx">number</span><span class="p">):</span> <span class="nx">number</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">n</span> <span class="o">*</span> <span class="nx">n</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>A group of different possible types:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">stringifyBasicValue</span><span class="p">(</span><span class="nx">value</span><span class="p">:</span> <span class="nx">string</span> <span class="o">|</span> <span class="nx">number</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="dl">''</span> <span class="o">+</span> <span class="nx">value</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>A type based on another type:</p>

<p>Here the return type will be the same as the type of whatever value is passed into the function.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">identity</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">value</span><span class="p">:</span> <span class="nx">T</span><span class="p">):</span> <span class="nx">T</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">value</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>These three are the most common categories of types. They will make up the majority of the types you’ll be writing.</p>

<p>However, there is also a fourth category.</p>

<p>An arbitrary type that could be anything:</p>

<p>Here the passed in value is an unknown type, it could be any type and the function would still work.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">getTypeOf</span><span class="p">(</span><span class="nx">value</span><span class="p">:</span> <span class="nx">mixed</span><span class="p">):</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">typeof</span> <span class="nx">value</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>When you try to use a value of a <code class="language-plaintext highlighter-rouge">mixed</code> type you must first figure out what the actual type is or you’ll end up with an error.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// @flow</span>
<span class="kd">function</span> <span class="nx">stringify</span><span class="p">(</span><span class="nx">value</span><span class="p">:</span> <span class="nx">mixed</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// $ExpectError</span>
  <span class="k">return</span> <span class="dl">""</span> <span class="o">+</span> <span class="nx">value</span><span class="p">;</span> <span class="c1">// Error!</span>
<span class="p">}</span>

<span class="nx">stringify</span><span class="p">(</span><span class="dl">"</span><span class="s2">foo</span><span class="dl">"</span><span class="p">);</span>
</code></pre></div></div>

<p>Instead you must ensure the value is a certain type by refining it.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// @flow</span>
<span class="kd">function</span> <span class="nx">stringify</span><span class="p">(</span><span class="nx">value</span><span class="p">:</span> <span class="nx">mixed</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">value</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">string</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="dl">""</span> <span class="o">+</span> <span class="nx">value</span><span class="p">;</span> <span class="c1">// Works!</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="dl">""</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">stringify</span><span class="p">(</span><span class="dl">"</span><span class="s2">foo</span><span class="dl">"</span><span class="p">);</span>
</code></pre></div></div>

<p>Because of the <code class="language-plaintext highlighter-rouge">typeof value === 'string'</code> check, Flow knows the <code class="language-plaintext highlighter-rouge">value</code> can only be a <code class="language-plaintext highlighter-rouge">string</code> inside of the <code class="language-plaintext highlighter-rouge">if</code> statement. This is known as a <a href="https://flow.org/en/docs/lang/refinements/">refinement</a>.</p>

<h2 id="references">References</h2>

<ul>
  <li><a href="https://flow.org/en/">Flow</a></li>
  <li><a href="https://flow.org/en/docs/install/">Install Flow</a></li>
</ul>
</article><br><nav aria-label="Page navigation"><ul class="pagination"><li class="page-item"><a class="page-link" href="/php7-zero-day-exploits-found">&laquo; PHP7 Zero Day Exploits Found</a></li> <li class="page-item"><a class="page-link" href="/make">Make &raquo;</a></li></ul></nav></div><div class="col-md-4"><aside class="sidebar"><div class="card"><img class="card-img-top" src="/dist/img/stormwild-logo.svg" alt="Card image cap"><div class="card-body"><h4 class="card-title">Alexander R. Torrijos</h4><p class="card-text">Experienced Web Developer (.NET C# Mvc, EF, Sql Server, PHP5, Html, Css, Js)</p><a href="/cv" class="btn btn-primary">Learn more &raquo;</a></div></div></aside></div></div></div></main><footer class="footer"><div class="container"><span class="text-muted">&copy; Copyright 2024 Alexander R. Torrijos.</span></div></footer></body></html>